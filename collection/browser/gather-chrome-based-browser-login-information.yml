rule:
  meta:
    name: gather chrome based browser login information
    namespace: collection/browser
    authors:
      - "@_re_fox"
      - still@teamt5.org
    scope: function
    att&ck:
      - Credential Access::Credentials from Password Stores::Credentials from Web Browsers [T1555.003]
    examples:
      - 2fd45662e3d0ec0077ea2fa66b6378f0:0x6000039
      - 54390bda109aab7fc006b8b4ead5b6c2
  features:
    - and:
      - or:
        - string: /\\(Edge|Chrome|Chromium|Brave\-Browser|YandexBrowser|Kometa|Orbitum|Dragon|Torch|Amigo|Webkit)\\User Data\\Default\\(Login Data|Cookies)/
        - string: /\\Opera Software\\Opera Stable\\(Login Data|Cookies)/
      - or:
        - string: /SELECT ((date_created|username_element|password_element|origin_url|signon_realm|action_url|username_value|password_value),?\s?)+ FROM logins/i
        - string: /SELECT ((creation_utc|encrypted_value),?\s?)+ FROM cookies/i
        - 2 or more:
          - string: /date_created/i
          - string: /username_element/i
          - string: /username_value/i
          - string: /password_element/i
          - string: /origin_url/i
          - string: /signon_realm/i
          - string: /action_url/i
          - string: /password_value/i
